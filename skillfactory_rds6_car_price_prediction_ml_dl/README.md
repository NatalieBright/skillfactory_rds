### Проект №6. Прогнозирование стоимости автомобиля по характеристикам, текстовому описанию и фото (ML и DL)
#### Цель проекта:
Предсказать стоимость автомобиля по имеющимся характеристикам, текстовому описанию и фотографии.

#### О данных

Данные предоставлены в таюличном виде, у каждой машины дана ссылка на фото.

#### Этапы работы
-Построим "наивную"/baseline модель, предсказывающую цену по модели и году выпуска (с ней будем сравнивать другие модели)

-Обработаем и отнормируем признаки

-Сделаем первую модель на основе градиентного бустинга с помощью CatBoost

-Сделаем вторую модель на основе нейронных сетей и сравним результаты

-Сделаем multi-input нейронную сеть для анализа табличных данных и текста одновременно

-Добавим в multi-input сеть обработку изображений

-Осуществим ансамблирование градиентного бустинга и нейронной сети (усреднение их предсказаний)

#### Подготовка данных
Предоставленные данные довольно чистые. В двух признаках были найдены и заполнены пропуски. 
Признак name был обработан, для того, чтобы достать полезную информацию. В процессе подготовки было добавлено несколько новых признаков.
Была выполнена нормализация числовых признаков, также обработка LabelEncoder и One-Hot Encoding категориальныз переменных.


#### Построение моделей
1. CatBoost

При построении модели были подобраны оптимальные параметры в ходе экспериментов. С помощью кросс валидации удалость улушить результат.

2. Simple neural network

При построении модели, опытным путем были выявлены наилучшие параметры, что в сумме помогло улучшить score. При загрузке результатов на kaggle модель показала лучше результат, чем CatBoost.
Самый лучший результат на Kaggle дал blend моделей Simple neural network и CV CatBoost.

3. Multi-input нейронная сеть для анализа табличных данных и текста одновременно

Для построения модели на основе текста и табличных данных необходимо было подготовить текст. Для подготовки была использована лемматезация, также я избавилась от стоп-слов, латинских букв и лишних символов в тексте. 

В итоге модель показала результат немного хуже, чем простая нейронная сеть без текста. 

4.  Multi-input нейронная сеть для анализа табличных данных, текста и изображений одновременно

Так как данных было не много, то перед построением модели я добавила аугментацию c помощью библиотеки albumentations. 
Был использован итератор tf.data.Dataset, для оптимизации затрат памяти, при обучении модели. 
Для распознавания фотографий за основу была взята предобученая сеть EfficientNet-B4, так как она имеет меньшее количество параметров, чем другие версии этой сети, (что влияет на время обучения) и при этом показывает хорошие результаты. 
Итоговый результат так же оказался немного хуже, чем у обычной нейронной сети. 

5. Ансамблирование градиентного бустинга и нейронной сети (усреднение их предсказаний)

Финальным этапом работы над проектом было объединение результатов ML и DL моделей. Были взяты усредненные предсказания Simple neural network и CV CatBoost, 
а также  Multi-input нейронной сети, объединившую табличные данные, текст и изображение. В итоге наилучший результат mape 11.76% дал ансамбль Simple neural network и CV CatBoost.

### Итоги и выводы
При работе над проектом была проведена большая комплексная работа. Были применены следующие навыки:

-Иследование, обработка и подготовка данных. Закреплены знания о библиотеках pandas, numpy, matplotlib, seaborn, scipy

-Построение ML моделей. Закреплены знания о библиотеках sklearn, CatBoost

-Построение нейронных сетей. Изучены и отработы методы и библиотеки для обработки текста (nltk, pymystem3, Tokenizer, sequence) и изображений (ImageDataAugmentor, albumentations). был изучен новый инструмент - итератор tf.data.Dataset для передачи данных в метод .fit() модели keras.

Работа выпонялась на площадке Kaggle, которая предоставляет вычислительные мощности (CPU и GPU) для такого типа задач, что оказалось очень кстати при работе с текстом и изображениями.

Из результатов работы можно сделать вывод, что данная задача хорошо решается с помощью машинного обучения и простых нейронных сетей. Добавление текста и изображений в данной задаче не привело к улучшению результата, но опыт построения multi-input нейросетей был получен.

